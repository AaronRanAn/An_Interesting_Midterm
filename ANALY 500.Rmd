---
title: "ANALY 500 50 Mid-Term"
author: "Aaron An"
date: "March 12, 2016"
output: 
  html_document: 
    highlight: haddock
    theme: cosmo
---

This is my quant solution to the ANALY 500 50 Mid-Term test, which was pushed to github after the test was due and will be taken down immediately after the Spring quarter for academic integrity. 

### Packages and data restructure

Load necessary pacakges to make our lives easier. 

```{r message=F}
library(readr)
library(dplyr)
library(ggplot2)
library(survey)
library(knitr)
```

Before the analysis part, let's tidy up the data a little bit to make it easier to work with. The original data set is tiny and very excel-ish. 

```{r}
midterm <- read_csv("/Users/aaronan/Analytics/MS Analytics/1. ANLY 500 50/data/midterm.csv")

midterm %>% 
  select(c(1, 2:6)) %>% 
  mutate(res = "r1") -> res_1

midterm %>% 
  select(c(1, 7:11)) %>% 
  mutate(res = "r2") -> res_2

names(res_1) = c("cid", "wt", "cs", "ppp", "s", "pppws", "res")
names(res_2) = c("cid", "wt", "cs", "ppp", "s", "pppws", "res")

res = rbind(res_1, res_2)
```


Take a look at the wide and long format. Restructured data has a column indicates resturant, which is easier for `ggplot` and generate descriptive statistics. 

```{r}

midterm %>% head() %>% kable()
res %>% head() %>% kable()

```

```{r}
dim(midterm)
dim(res)
```


### Q3 & Q4: Mode, mean and media...

R doesn't have a default function for mode calculation,  let's make one

```{r}

Mode <- function(x) {
  ux <- unique(x)
  ux[which.max(tabulate(match(x, ux)))]
}

```

The calculate all the descriptive stats mentioned in the question:

```{r}

res %>% 
  group_by(res) %>% 
  summarise(var_cs = var(cs),
            sd_cs = sd(cs),
            avg_cs = mean(cs),
            mode_cs = Mode(cs)) %>% kable()

```

Plot the histogram of two distribution:

```{r}

ggplot(res, aes(x=cs, fill=res)) +
  geom_histogram(binwidth=.5, alpha=.5, position="identity")

```

### Q5

Use Shapiro test to determine normality (with two restaurant combined). 

```{r}

apply(res[,c(2:4,6)], 2, shapiro.test)

```

Looks like only wait time (`wt`) is not significant, but is it nearly normal? Let's plot it! 

```{r}

qqnorm(res$wt);qqline(res$wt, col = 2)

```

Looks like normal (not deviate from normal line too far). Let's plot it separately for two restuarants. 

```{r}

ggplot(res) + 
  stat_qq(aes(sample = wt, colour = factor(res)))

```

### Q6

Let's just plot the boxplot. 

```{r}

ggplot(res, aes(factor(res), wt)) +
  geom_boxplot(aes(fill = factor(res), alpha =0.5))+ 
  geom_jitter() 

```

And calculate the mean and sd

```{r}

res %>% 
  group_by(res) %>% 
  summarise(sd_wt = sd(wt),
            avg_wt = mean(wt))

```

### Q7

Two way to perform the test, depend on which data you are using:

```{r}
t.test(midterm$r2wt, midterm$r1wt)
```

```{r}
t.test(wt ~ res, data=res) 
```

### Q8

```{r}
t.test(wt ~ res, data=res)$p.value < 0.05
```

### Q10

```{r}

t_result = t.test(midterm$r2wt, midterm$r1wt, var.equal = F)

t_result

t_result$p.value

```

### Q11

```{r}

t_result1 = t.test(midterm$r1wt, midterm$r2wt, mu = 3.55, alternative = "less")

t_result1

t_result1$p.value < t_result$p.value

```

### Q12 

Note that in last question, in the result session shows: *true difference in means is less than 3.55*

### Q14 

```{r}

table(res$res, res$s)

```


### Q15 

Use t.test to see if the specials worked.

```{r}

res %>% 
  group_by(res, s) %>% 
  summarise(avg_ppp = mean(ppp, na.rm = T))

```

```{r}

t.test(ppp ~ s, data=res_1)

t.test(ppp ~ s, data=res_2) 

```

Both test are not significant, accept H-null, no effect of the special thing. 

